/*
  filename: angular.integralui.min.js
  version : 2.1.007
  Copyright © 2014-2015 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
angular.module("integralui",[]).directive("iuiResize",["$window","$timeout","IntegralUIInternalService",function(d,c,b){return{restrict:"A",link:function(a,e,f,h){var l=e.parent(),g=angular.element(d),m=parseInt(getComputedStyle(e[0]).width,10),q=parseInt(getComputedStyle(e[0]).height,10),k={},n=function(){if(k=a.$eval(f.iuiResize)){var n=b.isFieldAvailable(k.ref,"window"),d=m,h=q;switch(n){case "parent":l&&(k.width&&(d=Math.floor(k.width*l[0].clientWidth)),k.height&&(h=Math.floor(k.height*l[0].clientHeight)));break;case "page":k.width&&(d=Math.floor(k.width*g[0].innerWidth));k.height&&(h=Math.floor(k.height*g[0].innerHeight));break;default:k.width&&(d=Math.floor(k.width*g[0].outerWidth)),k.height&&(h=Math.floor(k.height*g[0].outerHeight))}e.css("width",d+"px");e.css("height",h+"px");var r=c(function(){a.$apply();c.cancel(r)},1)}};n();a.$watch(f.iuiResize,function(a,g){a!=g&&n()},!0);g.bind("resize",function(a){n()});a.$on("destroy",function(a){g&&g.unbind("resize")})}}}]).directive("iuiClass",function(){return{restrict:"A",link:function(d,c,b,a){b.$observe("iuiClass",function(a,b){a!=b&&(c.removeAttr("class"),""!=a&&c.addClass(a))})}}}).directive("iuiStyle",function(){return{restrict:"A",link:function(d,c,b,a){b.$observe("iuiStyle",function(a,b){if(a!=b)for(var d=a.split(";"),l=0;l<d.length;l++){var g=d[l].split(":");2==g.length&&c.css(g[0],g[1])}})}}}).directive("iuiShow",function(){return{restrict:"A",link:function(d,c,b,a){b.$observe("iuiShow",function(a,f){a!=f&&("false"!=a?"true"==b.showDefault?c.css("display","inline"):c.css("display","block"):c.css("display","none"))})}}}).factory("IntegralUIPublicService",function(){var d=null;return{clearTempData:function(){d=null},getTempData:function(){return d},setTempData:function(c){d=c}}}).factory("IntegralUIDataService",function(){return function(d){if(!d)return null;var c=d,b="id",a="pid",e="items",f="text";this.updateDataFields=function(g){g&&(b=g.id?g.id:"id",a=g.pid?g.pid:"pid",e=g.objects?g.objects:"items",f=g.text?g.text:"text")};this.updateDataFields(c.fields);this.update=function(a){a&&(c=a,this.updateDataFields(c.fields))};var h=angular.isDefined(c.objects);this.clear=function(a,b){var e=this.getList(a);0<e.length&&c.events&&c.events.clear({e:{parent:a}});e.length=0;b&&b()};this.insertAt=function(a,b,e,c){this.insert(a,b,e,null,!1,c)};this.insert=function(g,m,e,f,d,l){h&&!1!==(c.events?c.events.objAdding({e:{obj:g}}):!0)&&g&&(g[a]=e?e[b]:"",e=this.getList(e),0>m||null===m||void 0===m?e.push(g):(m=Math.max(Math.min(m,e.length),0),e.splice(m,0,g)),g[b]||(g[b]=this.getUniqueId()),c.events&&c.events.objAdded({e:{obj:g}}),l&&l())};this.insertByRef=function(a,b,e,c){if(h&&a&&b){var f=this.getParent(b),d=this.getList(f),d=this.getIndexOf(b,d);e&&(d+=1);this.insert(a,d,f,b,e,c);return d}};this.removeAt=function(g,b,e,f){if(h){var d=null;g&&(e=this.getParent(g),d=this.getList(e),b=this.getIndexOf(g,d));if(null===b||void 0===b)return!1;d=this.getList(e);if(0<=b&&b<d.length&&(g=d[b],!1!==(c.events?c.events.objRemoving({e:{obj:g}}):!0)))return g[a]="",d.splice(b,1),c.events&&c.events.objRemoved({e:{obj:g}}),f&&f(d,b,e),!0}return!1};this.isIndexinRange=function(a){return h&&0<=a&&a<c.objects.length?!0:!1};this.moveObject=function(a,b){h&&this.isIndexinRange(a)&&this.isIndexinRange(b)&&c.objects.splice(b,0,c.objects.splice(a,1)[0])};this.getNewIndex=function(a,b,e){if(h&&a&&b)return a=this.getParent(b),a=this.getList(a),b=this.getIndexOf(b,a),e&&(b+=1),b};this.getObjectByIndex=function(a){return h&&this.isIndexinRange(a)?c.objects[a]:null};this.findObjectById=function(a){return a?l(c.objects,a):null};this.findObjectByText=function(a){return a?l(c.objects,a,"text"):null};var l=function(a,c,d){var k=null;if(a&&c)for(var h=0,p=!1;!k&&h<a.length;){switch(d){case "text":a[h][f]&&(p=a[h][f].toString()===c.toString());break;default:a[h][b]&&(p=a[h][b].toString()===c.toString())}k=p?a[h]:l(a[h][e],c,d);h++}return k};this.getIndexOf=function(a,e){var c=-1;e||(e=this.getList());if(a&&e)for(var f=0;f<e.length;f++)if(e[f][b]&&a[b]&&e[f][b].toString()===a[b].toString()){c=f;break}return c};this.getList=function(a){return a?(a[e]||(a[e]=[]),a[e]):c.objects};this.findParent=function(c,f){var d=null;if(c&&f)for(var h=0;!d&&h<f.length;)d=f[h][b]&&c[a]&&f[h][b].toString()===c[a].toString()?f[h]:this.findParent(c,f[h][e]),h++;return d};this.getParent=function(a){return a?this.findParent(a,c.objects):null};this.getUniqueId=function(a){function b(){return(65536*(1+Math.random())|0).toString(16).substring(1)}a=a||"-";return b()+b()+a+b()+a+b()+a+b()+a+b()+b()+b()}}}).factory("IntegralUIDragDrop",function(){var d={dropPos:-1,source:null,sourceCtrl:null,sourceCollection:null,sourceIndex:-1,target:null,type:""},c=function(b,a,e){return b>=e.left&&b<=e.right&&a>=e.top&&a<=e.bottom?!0:!1};return{clearData:function(){d={dropPos:-1,source:null,sourceCtrl:null,sourceCollection:null,sourceIndex:-1,target:null,type:""}},getData:function(){return d},setData:function(b){b&&(isNaN(b.dropPos)||(d.dropPos=b.dropPos),b.source&&(d.source=b.source),b.sourceCtrl&&(d.sourceCtrl=b.sourceCtrl),b.sourceCollection&&(d.sourceCollection=b.sourceCollection),isNaN(b.sourceIndex)||(d.sourceIndex=b.sourceIndex),b.target&&(d.target=b.target),b.type&&(d.type=b.type))},hitTest:function(b,a,e){return c(b,a,e)},getDropPos:function(b,a,e,f){if(e)a:{e={left:a.x,top:a.y,right:a.x+a.width,bottom:a.y+a.height};if("horizontal"===f){e.right=a.x+a.width/2;if(c(b.x,b.y,e)){b=1;break a}e.left=e.right;e.right=a.x+a.width}else{e.bottom=a.y+a.height/2;if(c(b.x,b.y,e)){b=1;break a}e.top=e.bottom;e.bottom=a.y+a.height}b=c(b.x,b.y,e)?2:-1}else"horizontal"===f?(f={left:a.x+a.width/4,top:a.y,right:a.x+3*a.width/4,bottom:a.y+a.height},c(b.x,b.y,f)?b=0:(f.right=f.left,f.left=a.x,c(b.x,b.y,f)?b=1:(f.left=a.x+3*a.width/4,f.right=a.x+a.width,b=c(b.x,b.y,f)?2:-1))):(f={left:a.x,top:a.y+a.height/4,right:a.x+a.width,bottom:a.y+3*a.height/4},c(b.x,b.y,f)?b=0:(f.bottom=f.top,f.top=a.y,c(b.x,b.y,f)?b=1:(f.top=a.y+3*a.height/4,f.bottom=a.y+a.height,b=c(b.x,b.y,f)?2:-1)));return b}}}).factory("IntegralUIInternalService",["$rootScope","$window",function(d,c){var b=null;return{getCtrl:function(a){d.$broadcast(a+"-get-ctrl");a=this.getTempData();this.clearTempData();return a?a:null},getUniqueId:function(a,b){function c(){return(65536*(1+Math.random())|0).toString(16).substring(1)}var d=b||"-",d=c()+c()+d+c()+d+c()+d+c()+d+c()+c()+c();a&&(d=d.substring(0,a));return d},isBoolean:function(a){return a?"boolean"==typeof a:!1},isEnabled:function(a){return a||void 0===a?!0:!1},isEqual:function(a,b){return a&&b?a.toString()===b.toString():!1},isFieldAvailable:function(a,b){return void 0!=a?a:b},isImage:function(a){return a?a instanceof HTMLImageElement:!1},isNumber:function(a){return a?"number"==typeof a:!1},isObject:function(a){return a?"object"==typeof a&&null!=a&&!Array.isArray(a):!1},isPercent:function(a){return a&&(a=a.toString(),"%"==a.substring(a.length-1))?!0:!1},isSelected:function(a){return a&&a.selected?!0:!1},isString:function(a){return a?"string"==typeof a||a instanceof String:!1},clearTempData:function(){b=null},getTempData:function(){return b},setTempData:function(a){b=a},getBodyElem:function(a){for(var b=null;a;){if(a===document.getElementsByTagName("body")[0]){b=a;break}a=a.offsetParent}return b},checkHit:function(a,b,c){return a>=c.left&&a<=c.right&&b>=c.top&&b<=c.bottom?!0:!1},getMargin:function(a){return a?{top:parseInt(getComputedStyle(a)["margin-top"],10),right:parseInt(getComputedStyle(a)["margin-right"],10),bottom:parseInt(getComputedStyle(a)["margin-bottom"],10),left:parseInt(getComputedStyle(a)["margin-left"],10)}:{top:0,right:0,bottom:0,left:0}},getPadding:function(a){return a?{top:parseInt(getComputedStyle(a)["padding-top"],10),right:parseInt(getComputedStyle(a)["padding-right"],10),bottom:parseInt(getComputedStyle(a)["padding-bottom"],10),left:parseInt(getComputedStyle(a)["padding-left"],10)}:{top:0,right:0,bottom:0,left:0}},getMousePos:function(a){return{x:a.pageX?a.pageX:a.originalEvent?a.originalEvent.pageX:0,y:a.pageY?a.pageY:a.originalEvent?a.originalEvent.pageY:0}},getClientMousePos:function(a,b){if(a&&b){b=angular.element(b);var d=b[0].getBoundingClientRect(),h=angular.element(c)[0].pageXOffset,l=angular.element(c)[0].pageYOffset,g=this.getMousePos(a);g.x-=d.left+h;g.y-=d.top+l;return g}return{x:0,y:0}},getPageRect:function(a){if(a){a=angular.element(a);a=a[0].getBoundingClientRect();var b=angular.element(c)[0].pageXOffset,d=angular.element(c)[0].pageYOffset;a.left-=b;a.top-=d;a.right=a.left+a.width;a.bottom=a.top+a.height;return a}return{left:0,top:0,right:0,bottom:0}}}}]);